name: "real-time-chat"
version: "1.0.0"
description: "Modern real-time chat system with file sharing and collaboration features"
author: "BeamFlow System"
license: "MIT"
dependencies: ["socket.io", "fs-extra"]
permissions: 
  - "plugin:real-time-chat:read"
  - "plugin:real-time-chat:write"
  - "plugin:real-time-chat:admin"
  - "plugin:real-time-chat:moderate"

settings:
  max_message_length:
    type: "number"
    default: 1000
    required: true
    description: "Maximum message length in characters"
    validation: "value >= 1 && value <= 10000"
  
  file_upload_enabled:
    type: "boolean"
    default: true
    description: "Enable file upload functionality"
  
  max_file_size:
    type: "number"
    default: 10485760
    description: "Maximum file size in bytes (10MB)"
    validation: "value >= 1024 && value <= 104857600"
  
  allowed_file_types:
    type: "select"
    default: "images"
    description: "Allowed file types for upload"
    options: ["images", "documents", "all"]
  
  chat_rooms_enabled:
    type: "boolean"
    default: true
    description: "Enable multiple chat rooms"
  
  moderation_enabled:
    type: "boolean"
    default: false
    description: "Enable message moderation"
  
  auto_delete_messages:
    type: "boolean"
    default: false
    description: "Automatically delete old messages"
  
  message_retention_days:
    type: "number"
    default: 30
    description: "Number of days to retain messages"
    validation: "value >= 1 && value <= 365"

hooks:
  - name: "onRequest"
    description: "Process incoming chat requests"
    priority: 0
    enabled: true
  
  - name: "onUserJoin"
    description: "Handle user joining chat"
    priority: 0
    enabled: true
  
  - name: "onUserLeave"
    description: "Handle user leaving chat"
    priority: 0
    enabled: true
  
  - name: "onMessage"
    description: "Process chat messages"
    priority: 0
    enabled: true
  
  - name: "onFileUpload"
    description: "Handle file uploads"
    priority: 0
    enabled: true

ui:
  navigation:
    enabled: true
    title: "Team Chat"
    icon: "chat"
    path: "/plugins/real-time-chat"
    order: 10
    permissions: ["plugin:real-time-chat:read"]
  
  widgets:
    - name: "ChatWidget"
      description: "Real-time chat widget"
      component: "ChatWidget"
      permissions: ["plugin:real-time-chat:read"]
    
    - name: "ChatRoomsWidget"
      description: "Chat rooms management"
      component: "ChatRoomsWidget"
      permissions: ["plugin:real-time-chat:admin"]
    
    - name: "ChatStatsWidget"
      description: "Chat statistics and analytics"
      component: "ChatStatsWidget"
      permissions: ["plugin:real-time-chat:read"]
  
  pages:
    - name: "ChatPage"
      description: "Main chat interface"
      component: "ChatPage"
      path: "/plugins/real-time-chat"
      permissions: ["plugin:real-time-chat:read"]
    
    - name: "ChatSettingsPage"
      description: "Chat settings and configuration"
      component: "ChatSettingsPage"
      path: "/plugins/real-time-chat/settings"
      permissions: ["plugin:real-time-chat:admin"]
    
    - name: "ChatModerationPage"
      description: "Message moderation interface"
      component: "ChatModerationPage"
      path: "/plugins/real-time-chat/moderation"
      permissions: ["plugin:real-time-chat:moderate"]

api:
  routes:
    - method: "GET"
      path: "/messages"
      handler: "getMessages"
      middleware: ["auth"]
      permissions: ["plugin:real-time-chat:read"]
    
    - method: "POST"
      path: "/messages"
      handler: "createMessage"
      middleware: ["auth", "rateLimit"]
      permissions: ["plugin:real-time-chat:write"]
    
    - method: "DELETE"
      path: "/messages/:id"
      handler: "deleteMessage"
      middleware: ["auth"]
      permissions: ["plugin:real-time-chat:moderate"]
    
    - method: "GET"
      path: "/rooms"
      handler: "getRooms"
      middleware: ["auth"]
      permissions: ["plugin:real-time-chat:read"]
    
    - method: "POST"
      path: "/rooms"
      handler: "createRoom"
      middleware: ["auth"]
      permissions: ["plugin:real-time-chat:admin"]
    
    - method: "POST"
      path: "/upload"
      handler: "uploadFile"
      middleware: ["auth", "fileUpload"]
      permissions: ["plugin:real-time-chat:write"]
    
    - method: "GET"
      path: "/stats"
      handler: "getStats"
      middleware: ["auth"]
      permissions: ["plugin:real-time-chat:read"]
  
  websocket:
    - event: "join"
      handler: "handleJoin"
      permissions: ["plugin:real-time-chat:read"]
    
    - event: "leave"
      handler: "handleLeave"
      permissions: ["plugin:real-time-chat:read"]
    
    - event: "message"
      handler: "handleMessage"
      permissions: ["plugin:real-time-chat:write"]
    
    - event: "typing"
      handler: "handleTyping"
      permissions: ["plugin:real-time-chat:read"]
  
  middleware:
    - name: "auth"
      handler: "authenticateUser"
    
    - name: "rateLimit"
      handler: "rateLimitMessages"
    
    - name: "fileUpload"
      handler: "validateFileUpload"
  
  rateLimit:
    windowMs: 60000
    max: 30
